<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>장가계 장룡항공(룽에어) 요금표</title>

    <meta property="og:title" content="장가계 장룡항공(룽에어) 요금표">
    <meta property="og:type" content="article">
    <meta property="og:image" content="장가계_장룡항공(룽에어).pdf">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #ffffff;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-y: auto; /*  세로 스크롤은 유지 */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        #outer-container {
            width: 100%;
            display: flex;
            justify-content: center;
            background: #ffffff;
        }

        #pdf-container {
            width: 850px;
            background: #ffffff;
            overflow-x: hidden; /* 가로 스크롤바 숨김 */
            position: relative; /*  페이지 전환 효과를 위한 설정 */
            scroll-snap-type: x mandatory; /* 스냅 기능 추가 */

        }

        .pdf-page {
            width: 100%;
            /* height: 100vh;  <-  각 페이지 높이를 뷰포트 높이로 설정 (선택사항).  스크롤이 필요한 긴 PDF는 주석처리 */
            display: inline-block; /*  가로로 배치 */
            margin: 0;
            position: relative;
            background: #ffffff;
            line-height: 0;
           scroll-snap-align: center;  /* 각 페이지 중앙에 스냅 */
           scroll-snap-stop: always;   /*  스와이프 후 반드시 스냅 */
           flex-shrink: 0; /*  페이지 크기 축소 방지 */
        }
         /* 페이지 컨테이너 추가 (페이지 전환 애니메이션) */
        .page-container {
          display: flex; /*  flexbox를 사용하여 페이지 가로 배열 */
          width: fit-content; /*  내용물에 맞게 너비 자동 조절 */
          transition: transform 0.3s ease-out; /* 부드러운 페이지 전환 효과 */
        }

        canvas {
            width: 100% !important;
            height: auto !important;
            display: block;
        }


        /* (스크롤바 숨김 스타일은 그대로 유지) */
        ::-webkit-scrollbar {
            display: none;
        }

        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #666;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 8px;
            z-index: 1000;
        }
        /* 페이지 번호 표시 (선택 사항) */
        .page-number {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 100; /* 캔버스 위에 표시 */
        }


        @media (max-width: 880px) {
            #pdf-container {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div id="outer-container">
        <div id="pdf-container">
          <div class="page-container">
              </div>
        </div>
    </div>
    <div class="loading">문서를 불러오는 중...</div>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const pdfContainer = document.getElementById('pdf-container');
        const pageContainer = pdfContainer.querySelector('.page-container'); // 페이지 컨테이너
        const loadingDiv = document.querySelector('.loading');
        let currentScale = 1.5;
        let currentPage = 1; // 현재 페이지 번호
        let pdfDoc = null; // PDF 문서 객체 (전역)

        async function renderPage(pdfDoc, pageNum) {
            const page = await pdfDoc.getPage(pageNum);
            const viewport = page.getViewport({ scale: currentScale });

            const pageDiv = document.createElement('div');
            pageDiv.className = 'pdf-page';
            pageDiv.id = `page-${pageNum}`; // 페이지 ID 추가

            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');

            const outputScale = window.devicePixelRatio || 1;
            canvas.width = Math.floor(viewport.width * outputScale);
            canvas.height = Math.floor(viewport.height * outputScale);
            canvas.style.width = Math.floor(viewport.width) + "px";
            canvas.style.height = Math.floor(viewport.height) + "px";

            pageDiv.appendChild(canvas);

             // 페이지 번호 표시 (div) 추가
            const pageNumberDiv = document.createElement('div');
            pageNumberDiv.classList.add('page-number');
            pageNumberDiv.textContent = `Page ${pageNum} / ${pdfDoc.numPages}`;
            pageDiv.appendChild(pageNumberDiv);

            pageContainer.appendChild(pageDiv); // pageContainer에 추가


            const transform = outputScale !== 1
                ? [outputScale, 0, 0, outputScale, 0, 0]
                : null;

            await page.render({
                canvasContext: context,
                transform: transform,
                viewport: viewport
            }).promise;
             return pageDiv; // 렌더링된 페이지 div 반환
        }

        async function loadPDF() {
            try {
                const pdfUrl = 'https://raw.githubusercontent.com/born520/pdf/main/장가계_장룡항공(룽에어).pdf';  // PDF 파일 경로
                const loadingTask = pdfjsLib.getDocument(pdfUrl);
                pdfDoc = await loadingTask.promise; // pdfDoc 전역 변수에 할당

                loadingDiv.style.display = 'none';

                for (let pageNum = 1; pageNum <= pdfDoc.numPages; pageNum++) {
                   await renderPage(pdfDoc, pageNum); // 페이지 렌더링
                }
                goToPage(1); // 첫 페이지로 이동

            } catch (error) {
                console.error('PDF 로딩 에러:', error);
                loadingDiv.textContent = '문서를 불러올 수 없습니다.';
            }
        }

        loadPDF();


      // 페이지 이동 함수
        function goToPage(pageNum) {
          if (!pdfDoc) return; // pdfDoc이 로드되지 않았으면 이동 X
          if (pageNum < 1 || pageNum > pdfDoc.numPages) return; // 유효하지 않은 페이지

          const targetPage = document.getElementById(`page-${pageNum}`);
          if (targetPage) {
                const targetX = targetPage.offsetLeft; // 대상 페이지의 왼쪽 위치
                pageContainer.style.transition = 'transform 0.3s ease-out'; // 부드러운 전환 효과
                pageContainer.style.transform = `translateX(-${targetX}px)`; // 페이지 컨테이너 이동
                currentPage = pageNum;
          }
        }

        // 스와이프 이벤트 처리
        let touchStartX = 0;
        let touchEndX = 0;
        const swipeThreshold = 50; // 스와이프 감지 최소 거리 (픽셀)
        let isSwiping = false; // 스와이프 중인지 여부


        pdfContainer.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].clientX;
            isSwiping = true; // 터치 시작 시 스와이프 시작
            pageContainer.style.transition = 'none'; // 스와이프 중에는 전환 효과 없음
        }, { passive: true });


       pdfContainer.addEventListener('touchmove', function(e) {
          if (!isSwiping) return; // 스와이프 중이 아닐 때는 처리 X

            touchEndX = e.touches[0].clientX;
            let diffX = touchStartX - touchEndX;

             // 현재 페이지 오프셋 + 스와이프 이동 거리만큼 이동
            let currentTransform = - (currentPage -1) * pdfContainer.offsetWidth;
            pageContainer.style.transform = `translateX(${currentTransform - diffX}px)`;

        }, { passive: true });


        pdfContainer.addEventListener('touchend', function(e) {
             if (!isSwiping) return;
             isSwiping = false;

            let diffX = touchStartX - touchEndX;

            if (Math.abs(diffX) > swipeThreshold) {
                if (diffX > 0) {
                    // 왼쪽으로 스와이프 (다음 페이지)
                    goToPage(currentPage + 1);
                } else {
                    // 오른쪽으로 스와이프 (이전 페이지)
                    goToPage(currentPage - 1);
                }
            } else {
              // 스와이프 거리가 짧으면, 현재 페이지로 다시 이동 (제자리)
                goToPage(currentPage);
            }

        }, { passive: true });


        // 마우스 휠 이벤트 (선택 사항)
        pdfContainer.addEventListener('wheel', function(e) {
            if (e.deltaX > 0) {
              goToPage(currentPage + 1); // 오른쪽 휠 -> 다음페이지
            } else if (e.deltaX < 0) {
              goToPage(currentPage - 1); // 왼쪽 휠 -> 이전페이지
            }
            e.preventDefault(); // 기본 휠 동작(세로 스크롤) 방지

        }, { passive: false }); // passive: false로 설정하여 preventDefault() 호출


    </script>
</body>
</html>
